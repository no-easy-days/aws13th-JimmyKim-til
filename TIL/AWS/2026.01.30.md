# [2026-01-30]

## ☀️ 오늘의 목표 (Scrum)

- [Architecting on AWS 3일차]

## 📝 배운 내용 (Today I Learned)

## Architecting On AWS

### 네트워킹 Part.2
 >VPC를 여러개 구현하는 것의 이점은 무엇일까?

1. VPC 엔드포인트

  
  (1) 인터페이스 VPC 엔드포인트 : "네트워크 카드" 느낌. 내가 만든 VPC 내부 리소스를 각종 AWS 서비스(***VPC 바깥***에 있는 S3, DynamoDB, 기타 등등)로의 액세스 지원함.
     - ***IGW, NAT, Public IP 구성 필요 없어도 가능하다.***

  
  (2) 게이트웨이 VPC 엔드포인트 : 라우팅 테이블에 지정된 대상. 딱 2개의 서비스(**DynamoDB, S3**)만 지원.


2. VPC 피어링
  - 2개의 VPC 간에 네트워크를 연결하는 것. 리전 내 OK / 리전~리전 간 OK / 계정~계정 간 OK. ***1:1만 가능하다! 3개를 묶는 방식은 지원되지 않음!***
  - IGW 우회 가능 / SPOF 없이 고가용성 연결 제공 / 대역폭 병목 현상 방지 / Private IP 주소만으로도 VPC 간에 트래픽 전송 가능 


3. AWS Site-to-Site VPN
  - 온프레미스 환경을 고객의 게이트웨이 디바이스와 클라우드 환경의 Virtual Private 게이트웨이를 **VPN 형태로 연결**.
  - ***IPsec 터널링 방식***.
  - 최초 100GB는 무료이고, 시간당 연결 요금을 받는다. 속도에 민감하면 성능은 좀 떨어질 수 밖에 없다. (최대 1.25Gbps까지만)


4. AWS Direct Connect
  - VPN의 한계를 넘기 위해 ***전용선*** 형태로 구현.
  - 고객의 게이트웨이 디바이스와 이미 공개된 Direct Connect Position(서울 : 가산, 평촌) 사이를 물리적으로 연결하면 그 이후 부터는 AWS가 전용선으로 연결시켜준다.


5. Transit Gateway
  - 최대 5000개 이상의 VPC & 온프레미스 환경을 연결해주고, 일종의 ***허브*** 역할. 멀티 캐스트 & 리전 간 피어링 허용. 
     > 1:1이 되지 않던 VPC 피어링의 더 상위 개념이지만, 동일 리전에 있는 VPC만 연결할 수 있다! 리전~리전 간에는 VPC 피어링 필요. 
  - 하나 이상의 VPC, 하나 이상의 VPN 연결, Direct Connect Gateway, Transit Gateway 피어링 연결점 이랑 연결(Attachments) 할 수 있다.
  - 유연한 라우팅 및 세분화 가능 / 간편한 연결 / 고가용성 및 확장성 증대.


### 서버리스
  > 프로비저닝 또는 관리할 인프라가 없고, 소비 단위별로 오토 스케일링, 내장된 보안 & 고가용성 컴퓨팅, 종량제 요금.

1. API Gateway
  - 고객이 구성한 애플리케이션 or 웹사이트 등을 위한 진입점을 생성하고, 내부 트래픽으로 연결해줌. (VPC가 될수도 있고, Lambda, EC2 등등의 백엔드 서비스 쪽으로)
  - 여러 마이크로서비스의 통합을 위한 API 프론트엔드 역할을 함 / 백엔드를 위한 DDoS 보호 / 백엔드에 대한 인증 & 권한 부여 / 응답 캐싱


2. Simple Queue Service(SQS)
  - ***메시지 대기열 서비스***, 처리 및 삭제될 때까지 메시지를 저장한다. 발신자~수신자 간 버퍼 역할을 담당. ***느슨한 결합*** 구현.
  - Standard 유형(나가는 순서가 지켜지지 않음. 그냥 막 던지기 때문에 속도 개빠름) / FIFO 유형(큐 자체가 먼저 온 애를 내부적으로 체크해야하기 때문에, 속도 느릴수밖에.)
  - 짧은 폴링 유형(큐 쪽으로 지속적으로 요청함. 새로운 데이터 왔어?) / 긴 폴링(요청 한번 보낸 뒤, 큐가 2개 정도 채워지면 주세요~) 유형 중 선택.
  - 가시선 제한 시간 튜닝 : 동일 메시지가 전달되지 않도록 중복을 막는 기법이고, 그 시간을 바꿀(Tuning) 수 있다. (Default : 15 Min)
    > 비동기 작업 및 서비스~서비스 간 통신, 상태 변경 알림에 사용되지만, 특정 메시지를 선택하거나 대용량 메시지는 불가능함.


3. Simple Notification Service(SNS)
  - ***메시지 알림 서비스***, 게시자는 먼저 Topic을 만들고, 메시지 형태로 구독자에게 전송할 수 있다. (이메일, Json, 모바일 푸쉬 등 다양한 방식으로 지원)
  - HTTP or HTTPs 지원, ***회수는 불가능***하다. SQS와 비슷하게 Standard, FIFO 유형 중 선택할 수 있다.
  - SQS와 묶어서 ***팬 아웃*** 형태로 구성할 수 있다. (SNS 토픽으로 메시지를 전송하면 구독하고 있는 SQS 대기열로 메시지를 전달하는 패턴)


4. Kinesis
  - ***스트리밍 데이터 핸들링***
  - Kinesis Data Stream : 데이터 생산자가 Data Stream(여기가 AWS에서 제공)을 쓰고, 소비자는 그걸 읽는다. ***샤드*** 수를 지정할 수 있다.
    > 샤드 : 시퀀스 형태로 지정된 실시간 데이터를 보관하는 일종의 컨테이너
  - Kinesis Data Firehose : 데이터 스트림을 내가 원하는 형태로 모아다가 AWS 서비스 또는 3rd-Party를 연동할 수 있음.
  - Kinesis Video Stream : 스트림 데이터가 아니라 비디오(Youtube 같이) 스트림 데이터일 떄.


5. Step Functions
 - ***시각적 워크플로!***, 하나의 Lambda는 15분 이상 사용할 수 없고, 넘어가면 롤백된다. 여러 개의 Lambda와 다양한 AWS 서비스를 연동해야 하기 때문에 Step Functions를 활용한다.
 - 애플리케이션의 기능을 단계별로 실행시킬 수 있음 / 각 단계를 지속적으로 추적하며, 실패할 경우 오류 파악 및 로깅 제공. 
 - 상태 머신(State Machine, 이전 조건에 의존하는 일련의 작동 조건을 가진 객체. json 또는 GUI 모듈 형태)을 구현한 뒤, 그걸 가지고 Step Functions로 묶어 **오케스트레이션**이 가능하다.
 

### 자동화
  > 클라우드 인프라를 간편하게 구축하는 방법에 대한 고민... Terraform, Ansible, Openstack 정도의 3rd-party가 있다.

※ 코드형 인프라(laC)
  - 직접 클릭,클릭 또는 CLI 명령어, Shell Script로 했던걸 ①***아키텍쳐 템플릿***(리소스들 구성을 정의한 텍스트파일)을 가지고 ②IaC 솔루션을 활용하여 ③클라우드 인프라를 구현하는 기법.
  - 클라우드 인프라 구성의 버전 관리 / ***드리프트***(템플릿의 내용과 실제 구성되는 스택의 내용이 차이가 발생한 것. **diff**)를 **탐지** / 마지막 정상 상태로 **롤백**

1. CloudFormation
  - AWS의 코드형 인프라(IaC) 솔루션. 먼저 json 또는 yaml 형태로 템플릿을 작성해서 생성 또는 수정할 리소스를 기술하고, 업로드 & API 요청을 통해 변환하여 "리소스 스택"을 생성한다.
  - 스택 : 단일 단위로 관리되는 **AWS 리소스 모음**. 
  - 템플릿은 계층형 아키텍처 느낌으로 구분하여 생성하는 것이 좋다. (프론트엔드, 백엔드, 공유, 네트워크 설정, 자격증명 이런 식으로 나눠서 생성)

2. 인프라 도구
  - AWS Systems Manager : 관리용 도구 / AWS Elastic Beanstalk, AWS 솔루션 라이브러리, AWS Cloud Development Kit(CDK), AWS CloudFormation : 배포용 도구

  
    (1) Elastic Beanstalk
      - ***개발자 입장***에서 제공. 소스코드만 작성해서 Elastic Beanstalk에 넣으면 → 애플리케이션 배포, 돌아가기 위한 환경을 구성해준다. (스택 자동으로 제공 받고, 확인도 가능하고, Auto-Scaling 옵션도 가능)
  
  
    (2) AWS 솔루션 라이브러리
      - CloudFormation을 조금 더 편하게 쓰고싶을 때 사용. 사전에 구축된 템플릿을 바탕으로 사용자가 적합한 AWS 솔루션 라이브러리(AWS SA에게 검증받았음)를 선택해서 구매 & 적용
  
  
    (3) AWS CDK
      - 개발자 입장에서 익숙한 프로그래밍 언어(원하는 언어)를 ***CloudFormation 템플릿에 적합하도록 변환***할 수 있는 라이브러리를 제공한다.
  
  
    (4) AWS Systems Manager
      - 권한 부여, 구성 관리, 운영 및 규정 준수 & 관리, 모니터링 기능 제공.


3. Amazon Q ~ 생성형 AI 기반 어시스턴트.
   - Q Developer : 영어 주석 + 소스코드 작성, 소프트웨어 개발 수명 주기(SDLC) 전반을 지원. (계획(프롬프트 엔지니어링) → 생성(다양한 언어 및 IDE 호환) → 테스트 및 보안 → 운영 → 유지 관리 및 고도화)
   - Q  Business : 컨텐츠 생성 & 요약, 질의 응답 기능.


### 엣지 서비스
  > AWS 리전, 엣지 로케이션, AWS 로컬 존, AWS Outposts, AWS Snow 패밀리 를 아우르는, 고객이 필요로 하는 모든 위치에서 클라우드 인프라 환경을 제공.

1. AWS Route 53
  - ***DNS 서비스***. 도메인 이름을 IP로 확인하거나, 등록 or 이전 기능 제공. ***엣지 로케이션*** 레벨에서 돌아간다.
  - 퍼블릭 호스팅 영역 / 프라이빗 호스팅 영역(VPC 내부에 서브넷, 그 내부에 수많은 인스턴스가 있을 때, 걔네들 끼리 IP로 통신하는건 한계가 있으니 이름을 통해 통신하고자 할때) 제공
  - 라우팅 정책(Routing Policy) : 6가지 정책을 바탕으로 레코드 셋을 정의한다.


    (1) 단순(Simple) : 기본 DNS 기능


    (2) 장애 조치(Failover) : 액티브-스탠바이 장애 조치 필요한 경우에 맞춰 로드 밸런싱 프로세스 구현 (***Health-Check***를 포함)


    (3) 지리적 위치(Geolocation) : 클라이언트가 어느 지역에 있는 지에 따라 로드 밸런싱 프로세스 구현


    (4) 지리 근접(Geoproximity) : ***바이어스***(지역은 이미 나눠져있지만, 내가 지역적 범위를 지정하고 싶을 때.)를 조정할 수 있음.


    (5) 지연 시간 기반(Latency) : *지연 시간(Latency Time)*이 **가장 적은** 리전으로 로드 밸런싱 하는 프로세스 구현.


    (6) 다중값 응답(Multivalue) : 요청에 대해 다수의 리소스 값(최대 8개)을 반환할 수 있음. 클라이언트 관점의 로드밸런싱. Simple과 다르게 *Health-Check 가능*.  


    (7) 가중치 기반(Weighted) : 가중치를 할당해서 *점진적으로 사용자의 트래픽을 이동*하고 싶을 때 활용. (**9:1, 8:2, 7:3 느낌**으로 로드 밸런싱)  → "Blue-Green Release"


2. CloudFront
  - ***글로벌 CDN 서비스***. 자체 내장 보안 기능을 포함(또는 AWS WAF, AWS Shield와 통합 가능)하며 정적 뿐만 아니라 동적 컨텐츠 핸들링이 가능.
    >  리전 ~ 엣지로케이션 간 네트워크는 당연히 AWS 네트워크망을 타니까 동적 컨텐츠에 대한 핸들링에 있어서 이점이 있다.
  - 엣지 캐싱 : 엣지 로케이션에서 데이터를 캐싱하여 사용자의 요청에 대한 응답 시간을 단축할 수 있음. (물론, 데이터 없으면 Origin 까지 가긴 해야함.)
  - TCP 최적화 / TLS 1.3 지원 / 동적 컨텐츠 배치 기능을 제공 한다.
  - 구성 단계 : ①오리진 선택(S3, ELB, EC2 인스턴스 등등) ②배포 생성(경로 패턴, HTTP 메서드, 프로토콜 정책 등) ③선택 사항(Lambda, Lambda Edge 연동, WAF 등)
  - 사용자는 캐싱 전략을 선택할 수 있고, 캐시 적중률을 개선할 수 있다. CloudFront Origin Shield 를 활용하면 메모리 영역을 조금 더 확장해서 쓸 수도 있다. (물론 돈...)


3. AWS Shield
※ OSI 7 Layer에 따라 DDoS 공격 유형을 분류 해보면...
  - L3(UDP reflection attacks) & L4(SYN Floods) : Infra Layer 공격  
  - L6(SSL Abuse) : Presentation Layer 공격 
  - L7(HTTP floods, DNS query floods) : Application Layer 공격
  
  
    (1) Shield Standard : L3 & L4(Infra Layer)에 대한 DDoS를 막아줌.
  

    (2) Shield Advanced : L3, L4, L6, L7 계층에 대한 DDoS를 막아줌.


4. AWS WAF
  - Web Application Firewall. 보호하고자 하는 웹 애플리케이션을 선택하면 거기에 맞춰 방화벽을 구현해주는 서비스.
  - 액세스 제어 구성 요소 : ***웹 ACL***(XSS, SQL Injection은 AWS에서 제공하며, 상용 솔루션도 지정 가능하고 사용자가 원하는 필터링, 패턴 분석, 논리연산 다 가능), 규칙(Rule), 규칙 그룹 등.


5. AWS Firewall Manager
  - 계정 & 리소스 & 애플리케이션이 점점 늘어나면, **통합 관리 차원에서 보안 정책을 통일해야하는 니즈가 발생***한다.
  - 중앙에서 기준 보안을 설정할 수 있고, 일관적으로 보호 조치를 적용한다. 다중 계정에 대해서도 원활하게 관리 가능.
  - WAF, SG(보안그룹), Shield Advanced, Network Firewall, NACL 전부 포함해서 제어한다.


6. AWS Outposts
  - AWS 데이터센터 내에 온프레미스 환경을 구성해준다. 똑같이 리소스를 생성하고, Latency(지연 시간)가 짧은 워크로드를 지원할 수 있음. (랙 / 서버 형태로 구성 가능)


## 백업 및 복구
  > DR. 빠르게 살려내기 위해 항상 계획을 세우고 개선하고 세우고 개선하고 해야한다.

1. ***Recovery Point Objective(복구 시점 목표) 및 Recovery Time Objective(복구 시간 목표)***
  - RPO : 데이터 손실 최소화. 되도록이면 커야한다. 살려낼 수 있는 범위를 늘린다는 뜻. (몇 시간치 손실된건 어쩔수 없더라도 되살려내야 해!)
  - RTO : 가동 중단 시간 최소화. 되도록이면 줄여야한다. 빨리 살려내야한다는 뜻. (어플리케이션이 이 시간 까지는 정상화되어야 해!)


2. AWS에서 백업 및 복구 시나리오
  - 스토리지 복제
  - 복구용 AMI 구성
  - 장애 조치 네트워크 설계 : Route 53, ELB, VPC, Direct Connect 활용해야 한다.
  - 데이터베이스 백업 및 복제본 구축 : RDS(백업 시점 복구), DynamoDB(PitR) 활용, 각 서비스마다 백업(***최대 보관일: 35일***) 및 리커버리 옵션 이미 있고, 그걸 활용해서 DR 전략 수립해야 함.


3. AWS Backup
  - 완전 관리형 백업 서비스. AWS에서 제공하는 모든 리소스 & 서비스에 대하여 백업 기능 제공


4. AWS의 4가지 복구 전략
  - ①백업 및 복원 ②파일럿 라이트 ③웜 스탠바이 ④다중 사이트 액티브/액티브
  - 왼쪽으로 갈수록 RPO 낮고 RTO 높음. 오른쪽으로 갈수록 거의 준 실시간에 가깝게 대응 가능(RPO는 내가 원하는 만큼, RTO는 최소한으로)

### 컨테이너
  > 컴퓨팅 요구 사항에 맞게. 도커랑 쿠버네티스가 대표적인데... AWS에서는 컨테이너 이미지를 구성해서 문제없이 돌아가도록 서비스를 지원해준다.

1. 오케스트레이션 도구
  - ECS (for Docker)
  - EKS (for K8s)

2. 레지스트리
  - ECR (Docker 이미지를 여기다가 등록해서, 그걸 K8s에서 쓸수 있게 해준다.)

3. 컨테이너 호스팅
  - EC2 : 기본값
  - Fargate : 서버리스 형태로 인프라 구축할 때.

## 🔥 도전 과제 & 해결 (Challenge & Solution)

- **과제/문제**: X
- **시도 및 해결**: X

## 💭 오늘의 회고 (Retrospective)

- **Keep (좋았던 점)**: AWS 아키텍처 전반을 알게되었다. 난 정말 재미있었다.
- **Problem (아쉬웠던 점)**: 다른 ECS, EKS에 대해서도 공부해보고 싶다.
- **Try (시도할 점)**: Builders Lab 보기

## 🔗 참고 자료 (References)
