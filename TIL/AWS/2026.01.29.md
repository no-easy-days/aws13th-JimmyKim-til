# [2026-01-28]

## ☀️ 오늘의 목표 (Scrum)

- [Architecting on AWS 2일차]

## 📝 배운 내용 (Today I Learned)

## Architecting On AWS

### 스토리지
1. 객체스토리지 (S3 Bucket)
  - 기본값은 프라이빗으로 설정되고, **리소스 소유자**만 엑세스 가능. (퍼블릭 설정 시, 외부에서 접근 가능.)
  - Organization(SCP), IAM, 인스턴스 정책 기반으로 데이터 엑세스 제어 (json 기반)
  - 서버측 암호화(Server-Side-Encryption) : AWS한테 맡겨서 편함. 하지만, 데이터 전송 프로세스에서는 암호화되지 않은 상태이기 때문에 약간의 리스크 있음
     > 종류 : SSE-S3 / AWS KMS 키 / 이중 계층 서버 측 암호화(DSSE-KMS) / 고객 제공 키(SSE-C)
  - 종류 : S3 Express One Zone, S3 Standard(기본값), S3 Standard-1A / S3 Glacier Instant Retrieval, S3 Glacier Flexible Retrieval, S3 Glacier Deep Archive
     > 오른쪽으로 갈수록 액세스 빈도가 낮고, 액세스 빈도는 AWS Analyzer가 분석한 액세스 빈도 정보를 활용할 수 있다.
  
  
  ※ AWS Intelligent Tiering : 종류를 하나 선택하는 것이 아닌, AWS가 액세스 빈도 & 사용 패턴을 분석해서 자동으로 티어를 변경해주는 서비스.
  
  
  - S3 객체 복제 : 사용자가 객체를 복제하고 싶을 경우. 메타데이터 유지 복제 / 다른 클래스로의 복제 / 복제본 소유권 변경 / 다른 리전으로 복제
  - Transfer Acceleration : 엣지 로케이션 활용 방식. 전세계에 걸처 데이터를 주고 받아야 하는 경우.
  - ***이벤트 알림*** : 특정 객체 이벤트가 발생할 때 알림 받는 기능. Lambda의 이벤트 소스로서 많이 사용함!


2. 공유 파일 시스템 → **여러 인스턴스가 동일한 스토리지를 사용해야하는 경우.**
  - EFS : 리눅스 환경의 NFS v4.0 or 4.1 프로토콜을 통해 파일 공유. 프로비저닝 없이 자동으로 확장 / 축소되며, TCO 절감 효과  
  - FSx : 리눅스가 아닌 다른 OS에서도 쓸 수 있도록. Window 등등...


3. 데이터 마이그레이션 도구
  - AWS Snowball Edge : **오프라인 환경**에서 데이터를 물리적으로 전송을 하기 위한 도구.
  - AWS Storage Gateway : 기존 온프레미스에 가지고 있던 데이터를 필요에 따라 AWS 스토리지에 연결 및 확장함. **File / Tape / Volume** 형태에 맞춰 제공.
  - AWS Datasync : 에이전트 방식으로 작동, 온프레미스 환경에서 변경이 생길 때 마다 AWS 스토리지로 보내서 일관성을 확보함.

### 데이터베이스 서비스
  > EC2로 인프라만 제공 받고, DB 구축해서 사용도 가능하다. 하지만, AWS는 RDS 서비스를 통해 DB 까지 관리를 받을 수 있다!

1. RDS
   - HW, OS, DBMS 배포 및 유지 관리 & 모니터링 기능 제공, 컴퓨팅 & 스토리지 크기 조정
   - Aurora / PostgreSQL / MySQL / MariaDB / Oracle / MSSQL / DB2 등 지원
  
     
   (1) Multi-AZ 배포 : 다른 AZ로 Standby DB 인스턴스 구성(이중화랑 비슷함), 재해 발생 시 FailOver. 고가용성 확보


   (2) 읽기 전용 복제본 생성 : Primary DB 인스턴스와 동기화, 읽기 작업만 빼서 부하를 분산하는 효과.


   (3) 저장 데이터 암호화 : AWS KMS에 관리하며, 고유한 키를 바탕으로 저장되는 데이터를 암호화. 


2. Amazon Aurora
   - 클라우드 인프라 환경 구성을 위한 MySQL 및 PostgreSQL **호환성 보장** RDBMS.
   - DB 클러스터는 하나 이상의 복제본 DB 인스턴스와 클러스터 볼륨으로 구성되고, Primary DB를 제외한 나머지는 ***읽기 전용***으로 활용.
   - Aurora Serverless V2 : 온-디맨드 기반으로 용량 자동 확장 및 축소 구성. 


3. DynamoDB
   - 완전 관리형(***Serverless***) NoSQL DBMS.
     > 비관계형 데이터베이스 : 기본적으로 "Key-Value 쌍"으로 구성. PK는 반드시 필요하고, 파티션 키를 통해 데이터를 좀 더 분산할 수 있다.
   - 용량 관리 옵션 : RCU(읽기용량단위), WCU(쓰기용량단위)를 바탕으로 책정되며, 온디맨드(사용한 RCU, WCU 만큼 지불) / 프로비저닝됨(최대 RCU, WCU 설정)
   - 최종적 읽기 일관성(최근 완료된 쓰기 작업의 결과가 아닐 수 있음. 쪼금 늦게) / 강력한 읽기 일관성(읽기 요청 시 모든 쓰기 작업을 실시간으로 업데이트. 부하 높음)
   - 글로벌 테이블 : 리전 간 복제를 자동화하는 옵션. 


4. 데이터베이스 캐싱
   - DB와 정보를 주고 받는 어플리케이션 성능을 높이기 위해 사용하는 기술. AP 서버가 DB와 직접적으로 붙지 않고 캐싱 클러스터를 둬서, 빠르게 DB 정보를 읽음.
     > 캐싱 우선 순위 : 비교적 정적인 상태인 데이터(자주 변경 안되는 애들) > 자주 엑세스되는 데이터 > 쿼리속도가 느리고, 비용이 많이 드는 데이터(Join 등)
   - 캐싱 전략
  
      
     (1) 레이지 로딩(Lazy Loading) : 항상 *캐시 클러스터에 먼저 데이터를 요청*. 만약 데이터가 없으면 실제 DB 서버로 요청하고, 그 결과를 캐시에 반영.
         - 캐시 히트 비율이 높으면 고성능을 자랑하지만, 캐시 미스 비율이 높아질수록 성능이 더 떨어진다.


     (2) 라이트 스루(Write Thru) : 변경 작업이 생길 때 마다 DB 서버에 요청(반영) 먼저 하고, 그 다음 캐시 클러스터에 요청.
         - 데이터베이스와 캐시 클러스터가 일관되어 캐시 미스 비율을 현저히 낮출 수 있지만, 캐시 그 자체의 활용도가 떨어질 수 있다.


     (3) TTL(Time to Live) : 일반적으로 Lazy Loading과 같이 사용. 유지 기간을 설정하여 오래 된 애들은 없어지고 최신 애들만 남겨둬서 가득 차는 현상 방지.
        > 위에 3가지 중 하나를 선택하거나. 같이 사용할 수 있음.


   - AWS ElasticCache : AWS 클라우드 환경에서 캐시 환경을 원활하게 설정 및 관리 & 확장할 수 있는 서비스. Redis, Memcached 등의 오픈소스 메모리 엔진 지원
   - DynamoDB Accelerator(DAX) : 읽기 쓰기 시 마이크로초 단위의 응답성 보장. 고성능 애플리케이션에 적용할 수 있음.


5. 데이터베이스 마이그레이션 서비스
   - AWS Database Migration Service : 말 그대로 온프레미스 형태의 데이터베이스를 클라우드 환경으로 이관해주는 서비스
   - AWS Schema Conversion Tool : 각종 DBMS를 원하는 DBMS의 스키마 형태로 컨버젼 해주는 툴

### 모니터링 및 크기 조정
1. CloudWatch → "성능 모니터링 제공 서비스"
  - 가장 기본적으로, 5분 또는 1분 단위로 수집한 ***Metric(지표)***를 바탕으로 정보를 제공한다. Metric은 키&밸류 형식.


    (1) 표준 지표 : 자동으로 AWS에 의해 수집되는 것. 예시) EC2, S3, DB 자체의 성능


    (2) 사용자 지표 : 사용자가 설정해서 수집되는 것. 예시) EC2 인스턴스 내부의 AP 서버 성능, 초 단위까지 수집할 수 있도록 설정 가능 
  - Logs : 실제 애플리케이션 단의 **Log**를 활용하며 CloudWatch Agent를 해당 인스턴스에 설정 해줘야한다. 네트워크 트래픽 정보 수집 또한 가능(VPC Flow Log)
  - Alarm : **임계값** 설정. OK / Alarm / Insufficient Data 3가지 상태로 분류함.
  - Event : EventBridge 서비스로 옮겨갔다. 이벤트가 발생하면 그걸 가지고 후속 조치, 연계 워크플로(e.g. Lambda 등) 구현 기능 제공


    (1) Schedule Event : 리눅스 크론탭, 윈도우 스케줄러 처럼 특정 시간에 작업을 수행하도록 지정


    (2) Rule Event : "대상", "상태(AWS가 리스트를 제공함)", "작업(AWS 서비스로 연계하도록 지정)".

  
  ※ CloudTrail : 사용자의 활동 및 API 사용 이력을 추적함.
     - 누가, 무엇이, 언제, 어떤 행위를, 어디 리전에서, 어떤 응답을 했는지 추적 가능 (Log 기반)


2. Elastic Load Balancing(ELB) → "로드밸런싱" 
  - 여러 대상에 자동으로 트래픽을 분산 뿐만 아니라, 상태 확인(Health-Check)을 주기적으로 수행.
  - ***리스너***로 구성되어 있고, 이 리스너는 유형별로 다르지만 조건에 맞추어 하나 이상의 대상 그룹에 요청을 전달함.


    (1) ALB (L7 레이어) - HTTP or HTTPs. 


    (2) NLB (L4 레이어) - TCP or UDP 등.


    (3) GLB (L3 레이어) - IP. 


3. Auto Scaling → "규모 조정"
  - 온프레미스 환경일 경우, 비용과 성능 향상 지표가 계단식. 이로 인해 기회비용&상실이 많이 발생한다. 이를 클라우드 기술의 "탄력성"을 바탕으로 해소 가능.
  - 시작 템플릿(Launch template) : 어떤 리소스가 필요한지 "문서화"되어 있음
  - Auto Scaling 그룹 : 어디에, "얼마나" 필요한지 설정.
  - 규모 조정 정책 : 언제, 얼마나 필요한지 설정.
  - 규모 조정 방법 : 예약됨(이때 얼만큼 쓸꺼에요~~) / 동적(그때 그때 워크로드에 따라 규모 조정) / 예측(AWS야 니가 보고 조정해줘)

## 실습 중 고민해보고 찾아본 것
 - NAT Gateway :  Private Subnet 내부로 들어오는 트래픽을 차단, 외부로 나가는 트래픽은 허용한다. ***In-Bound를 허용하지않음!!!!!!!***, 외부에서는 서버의 실제 IP를 모르고 NAT 게이트웨이의 IP만 알수있기 때문에, 만약에 그 IP로 뭔가 트래픽이 발생해도 NAT가 허용을 막아 버린다.
 - ALB : 목적 자체가 다르다. NAT Gateway와 다르게, 외부 사용자가 서비스에 접속할 수 있는 접점 역할이고, 내부로 들어오는 트래픽을 허용해줘야할 때 사용한다. 아키텍처 구성도에서 VPC 내부에 있는건 얘는 인스턴스가 아니라 그저 ***매니지드 서비스*** 이기 때문!
   > 퍼블릭 서브넷이 아예 없으면 외부 접근 자체가 불가능하고, Internet-Facing ALB가 반드시 퍼블릭 서브넷에 구성된 상태여야 한다. 그리고 AWS는 AZ가 2개 이상이어야만 ALB를 구성할 수 있도록 "강제"한다.

## 🔥 도전 과제 & 해결 (Challenge & Solution)

- **과제/문제**: X
- **시도 및 해결**: X

## 💭 오늘의 회고 (Retrospective)

- **Keep (좋았던 점)**: 복습에 복습을 하다보니 좀 익숙해진 것 같다.
- **Problem (아쉬웠던 점)**: 과제할 시간이 없네...
- **Try (시도할 점)**: 복습~~

## 🔗 참고 자료 (References)
[참고 링크] https://cookielong.tistory.com/26
